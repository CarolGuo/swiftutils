SwiftUtils
==========

Utility Library in Swift.

By Thanh Ba Nguyen (btnguyen2k (at) gmail.com).

Project home:
[https://github.com/btnguyen2k/swiftutils](https://github.com/btnguyen2k/swiftutils)


## License ##

See LICENSE.txt for details. Copyright (c) 2016 Thanh Ba Nguyen.

Third party libraries are distributed under their own license(s).


## Release Notes ##

Latest release version: `1.0`. See [RELEASE-NOTES.md](RELEASE-NOTES.md) for details.

SnowflakeIdGenerator
--------------------

Swift implementation of Twitter's Snowflake algorithm.

Usage:

```swift
let idGen = SwiftIdGenerator()

// or
// let nodeId: UInt64 = calcDeviceIdAsInt()
// let idGen = SwiftIdGenerator(nodeId)

let id64 = idGen.generateId64()         // generate a 64-bit id
let id64Hex = idGen.generateid64Hex()   // generate a 64-bit id as a hex string
let id128Hex = idGen.generateid128Hex() // generate a 128-bit id as a hex string

// extract the timestamp as a UNIX timestamp in millisecond from a generated id
let timestamp = SwiftIdGenerator.extractTimestamp64(id64)

// extract the timestamp as a NSDate from a generated id
let date = SwiftIdGenerator.extractTimestamp128HexAsDate(id128Hex)
```

Provided functions:

- 64-bit ID (format Format `<41-bits: timestamp><21-bits: node id><2-bits: sequence number>`, where timestamp is in millisec, minus the epoch):
  - `generateId64() -> UInt64`: generate a 64-bit id.
  - `generateId64Hex() -> String`: generate a 64-bit id as a hex string.
  - `generateId64Bin() -> String`: generate a 64-bit id as a binary string.
  - `static extractTimestamp64(id: UInt64) -> UInt64`: extract the UNIX timestamp from a 64-bit id generated by `generateId64()`.
  - `static extractTimestamp64Hex(idHex: String) -> UInt64`: extract the UNIX timestamp from a 64-bit id generated by `generateId64Hex()`.
  - `static extractTimestamp64Bin(idBin: String) -> UInt64`: extract the UNIX timestamp from a 64-bit id generated by `generateId64Bin()`.
  - `static extractTimestamp64AsDate(id: UInt64) -> NSDate`: extract the timestamp part from a 64-bit id generated by `generateId64()` as a `NSDate`.
  - `static extractTimestamp64HexAsDate(idHex: String) -> NSDate`: extract the timestamp part from a 64-bit id generated by `generateId64Hex()` as a `NSDate`.
  - `static extractTimestamp64BinAsDate(idBin: String) -> NSDate`: extract the timestamp part from a 64-bit id generated by `generateId64Bin()` as a `NSDate`.
- 64-bit-nul ID (format Format `<41-bits: timestamp><23-bits: node id>` (no sequence part), where timestamp is in millisec, minus the epoch):
  - `generateId64Nil() -> UInt64`: generate a 64-bit id.
  - `generateId64NilHex() -> String`: generate a 64-bit id as a hex string.
  - `generateId64NilBin() -> String`: generate a 64-bit id as a binary string.
  - `static extractTimestamp64Nil(id: UInt64) -> UInt64`: extract the UNIX timestamp from a 64-bit id generated by `generateId64Nil()`.
  - `static extractTimestamp64NilHex(idHex: String) -> UInt64`: extract the UNIX timestamp from a 64-bit id generated by `generateId64NilHex()`.
  - `static extractTimestamp64NilBin(idBin: String) -> UInt64`: extract the UNIX timestamp from a 64-bit id generated by `generateId64NilBin()`.
  - `static extractTimestamp64NilAsDate(id: UInt64) -> NSDate`: extract the timestamp part from a 64-bit id generated by `generateId64Nil()` as a `NSDate`.
  - `static extractTimestamp64NilHexAsDate(idHex: String) -> NSDate`: extract the timestamp part from a 64-bit id generated by `generateId64NilHex()` as a `NSDate`.
  - `static extractTimestamp64NilBinAsDate(idBin: String) -> NSDate`: extract the timestamp part from a 64-bit id generated by `generateId64NilBin()` as a `NSDate`.
- 128-bit ID (format Format `<64-bits: timestamp><48-bits: node id><16-bits: sequence number>`, where timestamp is in millisec):
  - `generateId128() -> [UInt64]`: generate a 128-bit id as an array of two UInt64s.
  - `generateId128Hex() -> String`: generate a 128-bit id as a hex string.
  - `generateId128Bin() -> String`: generate a 128-bit id as a binary string.
  - `static extractTimestamp128Hex(idHex: String) -> UInt64`: extract the UNIX timestamp from a 128-bit id generated by `generateId128Hex()`.
  - `static extractTimestamp128Bin(idBin: String) -> UInt64`: extract the UNIX timestamp from a 128-bit id generated by `generateId128Bin()`.
  - `static extractTimestamp128HexAsDate(idHex: String) -> NSDate`: extract the timestamp part from a 128-bit id generated by `generateId128Hex()` as a `NSDate`.
  - `static extractTimestamp128BinAsDate(idBin: String) -> NSDate`: extract the timestamp part from a 128-bit id generated by `generateId128Bin()` as a `NSDate`.


SyncUtils
---------

* Synchronizes a code block: *

```swift
let result = synchronizd(lockObj) {
//     .... code here ....
}
```

DateTimeUtils
-------------

Datetime utility class.

- `static currentUnixTimestampMillisec() -> UInt64`: get current UNIX timestamp in milliseconds.
- `static currentUnixTimestampSecond() -> UInt64`: get current UNIX timestamp in seconds.
- `static waitTillNextMillisec(currentMillisec: UInt64) -> UInt64`: wait until clock moves to the next millisecond (method returns the "next" millisecond).
- `static waitTillNextSecond(currentSecond: UInt64) -> UInt64`: wait until clock moves to the next second (method returns the "next" second).
